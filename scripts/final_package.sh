#!/bin/bash

# nRF52810-AirTag-Toolkit æœ€ç»ˆæ‰“åŒ…è„šæœ¬
# åˆ›å»ºå®Œæ•´çš„é¡¹ç›®å‘å¸ƒåŒ…

set -e

PROJECT_NAME="nRF52810-AirTag-Toolkit"
FINAL_PACKAGE="${PROJECT_NAME}-Final-$(date +%Y%m%d-%H%M%S)"

echo "ðŸŽ¯ === nRF52810-AirTag-Toolkit æœ€ç»ˆæ‰“åŒ…å·¥å…· ==="
echo ""
echo "ðŸ“¦ æ­£åœ¨åˆ›å»ºæœ€ç»ˆå‘å¸ƒåŒ…: $FINAL_PACKAGE"
echo ""

# æ£€æŸ¥å¿…è¦æ–‡ä»¶
echo "ðŸ” æ£€æŸ¥å¿…è¦æ–‡ä»¶..."

required_files=(
    "README-æ–‡æ¡£å¯¼èˆª.md"
    "01-çŽ¯å¢ƒå®‰è£…æŒ‡å—.md"
    "02-é¡¹ç›®é…ç½®æ‰‹å†Œ.md"
    "03-å›ºä»¶ç¼–è¯‘æŒ‡å—.md"
    "04-ç¡¬ä»¶è¿žæŽ¥ä¸Žåˆ·å†™.md"
    "05-å¿«é€Ÿå‚è€ƒæ‰‹å†Œ.md"
    "06-æŠ€æœ¯åŽŸç†è§£æž.md"
    "07-é¡¹ç›®å¤‡ä»½ä¸Žéƒ¨ç½²æŒ‡å—.md"
    "08-é¡¹ç›®å¤‡ä»½æˆåŠŸæŒ‡å—.md"
    "setup_nrf52810.sh"
    "one_click_install.sh"
    "one_click_verify.sh"
    "compile_and_flash_2s.sh"
    "project_backup.sh"
)

missing_files=()
for file in "${required_files[@]}"; do
    if [ ! -f "$file" ]; then
        missing_files+=("$file")
    fi
done

if [ ${#missing_files[@]} -gt 0 ]; then
    echo "âŒ ç¼ºå°‘å¿…è¦æ–‡ä»¶:"
    for file in "${missing_files[@]}"; do
        echo "   - $file"
    done
    echo ""
    echo "è¯·ç¡®ä¿æ‰€æœ‰æ–‡ä»¶éƒ½å·²åˆ›å»ºå®Œæˆã€‚"
    exit 1
fi

echo "âœ… æ‰€æœ‰å¿…è¦æ–‡ä»¶æ£€æŸ¥é€šè¿‡"
echo ""

# åˆ›å»ºæœ€ç»ˆåŒ…ç›®å½•
echo "ðŸ“ åˆ›å»ºæœ€ç»ˆåŒ…ç›®å½•ç»“æž„..."
mkdir -p "$FINAL_PACKAGE"
cd "$FINAL_PACKAGE"

# åˆ›å»ºæ ‡å‡†ç›®å½•ç»“æž„
mkdir -p {docs,scripts,tools,config,examples}

echo "ðŸ“š å¤åˆ¶æ–‡æ¡£..."
cp ../*.md docs/

echo "ðŸ”§ å¤åˆ¶è„šæœ¬..."
cp ../setup_nrf52810.sh scripts/
cp ../one_click_install.sh scripts/
cp ../one_click_verify.sh scripts/
cp ../compile_and_flash_2s.sh scripts/
cp ../project_backup.sh scripts/
cp ../final_package.sh scripts/

# è®¾ç½®è„šæœ¬æ‰§è¡Œæƒé™
chmod +x scripts/*.sh

echo "ðŸ“¦ å¤åˆ¶é¡¹ç›®æºç ..."
if [ -d "../heystack-nrf5x" ]; then
    cp -r ../heystack-nrf5x .
    echo "âœ… é¡¹ç›®æºç å·²å¤åˆ¶"
else
    echo "âš ï¸  é¡¹ç›®æºç ç›®å½•æœªæ‰¾åˆ°ï¼Œå°†åˆ›å»ºç¤ºä¾‹ç»“æž„"
    mkdir -p heystack-nrf5x/nrf52810/armgcc
    echo "# heystack-nrf5x é¡¹ç›®æºç " > heystack-nrf5x/README.md
fi

echo "ðŸ”‘ å¤åˆ¶å¯†é’¥å’Œé…ç½®æ–‡ä»¶..."
# å¤åˆ¶å¯†é’¥æ–‡ä»¶
if [ -f "../R0VVSW_keyfile" ]; then
    cp ../R0VVSW_keyfile config/
    echo "âœ… å¯†é’¥æ–‡ä»¶å·²å¤åˆ¶åˆ° config/"
elif [ -f "../heystack-nrf5x/nrf52810/armgcc/R0VVSW_keyfile" ]; then
    cp ../heystack-nrf5x/nrf52810/armgcc/R0VVSW_keyfile config/
    echo "âœ… å¯†é’¥æ–‡ä»¶å·²å¤åˆ¶åˆ° config/"
else
    echo "âš ï¸  å¯†é’¥æ–‡ä»¶æœªæ‰¾åˆ°ï¼Œè¯·æ‰‹åŠ¨æ·»åŠ "
fi

# å¤åˆ¶é…ç½®æ–‡ä»¶
if [ -f "../openocd.cfg" ]; then
    cp ../openocd.cfg config/
elif [ -f "../heystack-nrf5x/nrf52810/armgcc/openocd.cfg" ]; then
    cp ../heystack-nrf5x/nrf52810/armgcc/openocd.cfg config/
fi

echo "ðŸ’¾ å¤åˆ¶å·²ç¼–è¯‘å›ºä»¶..."
if [ -d "../heystack-nrf5x/nrf52810/armgcc/_build" ]; then
    mkdir -p firmware
    cp -r ../heystack-nrf5x/nrf52810/armgcc/_build firmware/
    echo "âœ… å·²ç¼–è¯‘å›ºä»¶å·²å¤åˆ¶"
else
    echo "âš ï¸  æœªæ‰¾åˆ°å·²ç¼–è¯‘å›ºä»¶"
fi

echo "ðŸ› ï¸  åˆ›å»ºå·¥å…·è¯´æ˜Ž..."
cat > tools/TOOLS_REQUIRED.md << 'EOF'
# å¿…éœ€å·¥å…·æ¸…å•

## è‡ªåŠ¨å®‰è£… (æŽ¨è)
```bash
# è¿è¡Œä¸€é”®å®‰è£…è„šæœ¬
./scripts/one_click_install.sh

# éªŒè¯å®‰è£…
./scripts/one_click_verify.sh
```

## æ‰‹åŠ¨å®‰è£…

### Homebrew å®‰è£…çš„å·¥å…·
```bash
# å®‰è£… Homebrew (å¦‚æžœæœªå®‰è£…)
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# å®‰è£…å¼€å‘å·¥å…·
brew install --cask gcc-arm-embedded
brew install openocd
brew install libusb
brew install --cask nordic-nrf-command-line-tools
brew install git python3
```

### Python åŒ…
```bash
pip3 install intelhex
```

### æ‰‹åŠ¨ä¸‹è½½
- **nRF5 SDK 15.3.0**: https://www.nordicsemi.com/Software-and-tools/Software/nRF5-SDK
  - ä¸‹è½½åŽè§£åŽ‹åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ `nrf-sdk/` æ–‡ä»¶å¤¹

## éªŒè¯å®‰è£…
è¿è¡ŒéªŒè¯è„šæœ¬æ£€æŸ¥æ‰€æœ‰å·¥å…·æ˜¯å¦æ­£ç¡®å®‰è£…ï¼š
```bash
./scripts/one_click_verify.sh
```

## æ•…éšœæŽ’é™¤
å¦‚æžœé‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- `docs/01-çŽ¯å¢ƒå®‰è£…æŒ‡å—.md` - è¯¦ç»†å®‰è£…è¯´æ˜Ž
- `docs/05-å¿«é€Ÿå‚è€ƒæ‰‹å†Œ.md` - å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ
EOF

echo "ðŸ“‹ åˆ›å»ºé¡¹ç›®ä¿¡æ¯æ–‡ä»¶..."
cat > PROJECT_INFO.md << EOF
# nRF52810 AirTag å¼€å‘å·¥å…·åŒ…

## ðŸ“Š é¡¹ç›®ä¿¡æ¯
- **é¡¹ç›®åç§°**: nRF52810-AirTag-Toolkit
- **åˆ›å»ºæ—¶é—´**: $(date '+%Yå¹´%mæœˆ%dæ—¥ %H:%M:%S')
- **ç‰ˆæœ¬**: v1.0
- **é€‚ç”¨ç³»ç»Ÿ**: macOS (Intel & Apple Silicon)
- **ç›®æ ‡èŠ¯ç‰‡**: nRF52810
- **åè®®**: Apple Find My / AirTag

## ðŸ“ ç›®å½•ç»“æž„
\`\`\`
nRF52810-AirTag-Toolkit/
â”œâ”€â”€ ðŸ“š docs/                    # å®Œæ•´æ–‡æ¡£ç³»ç»Ÿ (9ä¸ªæ–‡æ¡£)
â”‚   â”œâ”€â”€ 01-çŽ¯å¢ƒå®‰è£…æŒ‡å—.md       # å¼€å‘çŽ¯å¢ƒæ­å»º
â”‚   â”œâ”€â”€ 02-é¡¹ç›®é…ç½®æ‰‹å†Œ.md       # é¡¹ç›®é…ç½®è¯´æ˜Ž
â”‚   â”œâ”€â”€ 03-å›ºä»¶ç¼–è¯‘æŒ‡å—.md       # ç¼–è¯‘æµç¨‹è¯¦è§£
â”‚   â”œâ”€â”€ 04-ç¡¬ä»¶è¿žæŽ¥ä¸Žåˆ·å†™.md     # ç¡¬ä»¶æ“ä½œæŒ‡å—
â”‚   â”œâ”€â”€ 05-å¿«é€Ÿå‚è€ƒæ‰‹å†Œ.md       # å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥
â”‚   â”œâ”€â”€ 06-æŠ€æœ¯åŽŸç†è§£æž.md       # æ·±åº¦æŠ€æœ¯åˆ†æž
â”‚   â”œâ”€â”€ 07-é¡¹ç›®å¤‡ä»½ä¸Žéƒ¨ç½²æŒ‡å—.md # å¤‡ä»½éƒ¨ç½²è¯´æ˜Ž
â”‚   â”œâ”€â”€ 08-é¡¹ç›®å¤‡ä»½æˆåŠŸæŒ‡å—.md   # å¤‡ä»½æˆåŠŸå±•ç¤º
â”‚   â””â”€â”€ README-æ–‡æ¡£å¯¼èˆª.md       # æ–‡æ¡£å¯¼èˆªå…¥å£
â”œâ”€â”€ ðŸ”§ scripts/                 # è‡ªåŠ¨åŒ–è„šæœ¬é›†åˆ
â”‚   â”œâ”€â”€ setup_nrf52810.sh       # çŽ¯å¢ƒæ£€æŸ¥è„šæœ¬
â”‚   â”œâ”€â”€ one_click_install.sh    # ä¸€é”®å®‰è£…è„šæœ¬
â”‚   â”œâ”€â”€ one_click_verify.sh     # ä¸€é”®æ£€éªŒè„šæœ¬
â”‚   â”œâ”€â”€ compile_and_flash_2s.sh # ä¸€é”®ç¼–è¯‘åˆ·å†™
â”‚   â”œâ”€â”€ project_backup.sh       # é¡¹ç›®å¤‡ä»½è„šæœ¬
â”‚   â””â”€â”€ final_package.sh        # æœ€ç»ˆæ‰“åŒ…è„šæœ¬
â”œâ”€â”€ ðŸ’¾ firmware/                # å·²ç¼–è¯‘å›ºä»¶ (å¦‚æžœå­˜åœ¨)
â”‚   â””â”€â”€ _build/                 # ç¼–è¯‘è¾“å‡ºç›®å½•
â”œâ”€â”€ âš™ï¸ config/                  # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ R0VVSW_keyfile          # å¯†é’¥æ–‡ä»¶
â”‚   â””â”€â”€ openocd.cfg             # OpenOCD é…ç½®
â”œâ”€â”€ ðŸ“¦ heystack-nrf5x/          # é¡¹ç›®æºç 
â”‚   â””â”€â”€ nrf52810/               # nRF52810 ç‰¹å®šä»£ç 
â”œâ”€â”€ ðŸ› ï¸ tools/                   # å·¥å…·è¯´æ˜Ž
â”‚   â””â”€â”€ TOOLS_REQUIRED.md       # å¿…éœ€å·¥å…·æ¸…å•
â”œâ”€â”€ ðŸ“‹ PROJECT_INFO.md          # æœ¬æ–‡ä»¶
â”œâ”€â”€ ðŸ“– USAGE.md                 # å¿«é€Ÿä½¿ç”¨æŒ‡å—
â””â”€â”€ ðŸš€ QUICKSTART.md            # 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹
\`\`\`

## ðŸŽ¯ é¡¹ç›®ç‰¹è‰²

### ðŸ“š å®Œæ•´æ–‡æ¡£ä½“ç³»
- **å¾ªåºæ¸è¿›**: ä»Žé›¶åŸºç¡€åˆ°ä¸“å®¶çº§åˆ«
- **å®žç”¨å¯¼å‘**: æ¯ä¸ªæ­¥éª¤éƒ½ç»è¿‡å®žé™…éªŒè¯
- **é—®é¢˜è§£å†³**: æ¶µç›–å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### ðŸ”§ è‡ªåŠ¨åŒ–è„šæœ¬
- **ä¸€é”®å®‰è£…**: è‡ªåŠ¨å®‰è£…æ‰€æœ‰å¿…éœ€å·¥å…·
- **ä¸€é”®æ£€éªŒ**: éªŒè¯çŽ¯å¢ƒå®Œæ•´æ€§
- **ä¸€é”®ç¼–è¯‘**: ç¼–è¯‘å¹¶åˆ·å†™å›ºä»¶
- **ä¸€é”®å¤‡ä»½**: åˆ›å»ºå®Œæ•´é¡¹ç›®å¤‡ä»½

### ðŸ›¡ï¸ å®‰å…¨å¯é 
- **å¯†é’¥ç®¡ç†**: å®‰å…¨çš„å¯†é’¥æ–‡ä»¶å¤„ç†
- **ç‰ˆæœ¬æŽ§åˆ¶**: å®Œæ•´çš„ç‰ˆæœ¬è¿½è¸ª
- **å¤‡ä»½æ¢å¤**: å¯é çš„å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 5åˆ†é’Ÿä½“éªŒ
\`\`\`bash
# 1. æ£€æŸ¥çŽ¯å¢ƒ (è‡ªåŠ¨å®‰è£…ç¼ºå¤±å·¥å…·)
./scripts/one_click_verify.sh

# 2. å¦‚æžœçŽ¯å¢ƒä¸å®Œæ•´ï¼Œè¿è¡Œå®‰è£…è„šæœ¬
./scripts/one_click_install.sh

# 3. è¿žæŽ¥ç¡¬ä»¶åŽä¸€é”®åˆ·å†™
./scripts/compile_and_flash_2s.sh
\`\`\`

### å®Œæ•´å­¦ä¹ è·¯å¾„
1. **é˜…è¯»æ–‡æ¡£å¯¼èˆª**: \`docs/README-æ–‡æ¡£å¯¼èˆª.md\`
2. **çŽ¯å¢ƒæ­å»º**: \`docs/01-çŽ¯å¢ƒå®‰è£…æŒ‡å—.md\`
3. **é¡¹ç›®é…ç½®**: \`docs/02-é¡¹ç›®é…ç½®æ‰‹å†Œ.md\`
4. **ç¡¬ä»¶æ“ä½œ**: \`docs/04-ç¡¬ä»¶è¿žæŽ¥ä¸Žåˆ·å†™.md\`
5. **æ—¥å¸¸å‚è€ƒ**: \`docs/05-å¿«é€Ÿå‚è€ƒæ‰‹å†Œ.md\`

## ðŸ“ž èŽ·å–å¸®åŠ©

### æ–‡æ¡£æŸ¥æ‰¾
- **å¿«é€Ÿé—®é¢˜**: æŸ¥çœ‹ \`docs/05-å¿«é€Ÿå‚è€ƒæ‰‹å†Œ.md\`
- **å…·ä½“æ“ä½œ**: æŸ¥çœ‹å¯¹åº”çš„è¯¦ç»†æ–‡æ¡£
- **åŽŸç†ç†è§£**: æŸ¥çœ‹ \`docs/06-æŠ€æœ¯åŽŸç†è§£æž.md\`

### å¤–éƒ¨èµ„æº
- [heystack-nrf5x GitHub](https://github.com/pix/heystack-nrf5x)
- [nRF5 SDK å®˜æ–¹æ–‡æ¡£](https://infocenter.nordicsemi.com/)
- [OpenOCD å®˜æ–¹æ–‡æ¡£](http://openocd.org/doc/)

## ðŸ”„ ç‰ˆæœ¬åŽ†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| v1.0 | $(date '+%Y-%m-%d') | åˆå§‹å‘å¸ƒç‰ˆæœ¬ï¼ŒåŒ…å«å®Œæ•´åŠŸèƒ½ |

---
*é¡¹ç›®åˆ›å»ºäºŽ: $(date '+%Yå¹´%mæœˆ%dæ—¥')*
EOF

echo "ðŸ“– åˆ›å»ºå¿«é€Ÿä½¿ç”¨æŒ‡å—..."
cat > USAGE.md << 'EOF'
# ðŸš€ å¿«é€Ÿä½¿ç”¨æŒ‡å—

## ðŸŽ¯ 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥: çŽ¯å¢ƒæ£€æŸ¥
```bash
# è¿è¡ŒçŽ¯å¢ƒæ£€æŸ¥å’Œè‡ªåŠ¨ä¿®å¤
./scripts/one_click_verify.sh

# å¦‚æžœæ£€æŸ¥å¤±è´¥ï¼Œè¿è¡Œè‡ªåŠ¨å®‰è£…
./scripts/one_click_install.sh
```

### ç¬¬äºŒæ­¥: é¡¹ç›®é…ç½®
```bash
# ä¸‹è½½ nRF5 SDK 15.3.0 (å¦‚æžœæœªä¸‹è½½)
# è®¿é—®: https://www.nordicsemi.com/Software-and-tools/Software/nRF5-SDK
# è§£åŽ‹åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ nrf-sdk/ æ–‡ä»¶å¤¹
```

### ç¬¬ä¸‰æ­¥: ç¡¬ä»¶è¿žæŽ¥
1. ä½¿ç”¨ ST-Link V2 è¿žæŽ¥ nRF52810
2. ç¡®ä¿è¿žæŽ¥æ­£ç¡® (å‚è€ƒ `docs/04-ç¡¬ä»¶è¿žæŽ¥ä¸Žåˆ·å†™.md`)

### ç¬¬å››æ­¥: ç¼–è¯‘åˆ·å†™
```bash
# ä¸€é”®ç¼–è¯‘å’Œåˆ·å†™å›ºä»¶
./scripts/compile_and_flash_2s.sh
```

## ðŸ“š è¯¦ç»†å­¦ä¹ è·¯å¾„

### æ–°æ‰‹å…¥é—¨ (æŽ¨èé¡ºåº)
1. `docs/README-æ–‡æ¡£å¯¼èˆª.md` - äº†è§£æ–‡æ¡£ç»“æž„
2. `docs/01-çŽ¯å¢ƒå®‰è£…æŒ‡å—.md` - æ­å»ºå¼€å‘çŽ¯å¢ƒ
3. `docs/02-é¡¹ç›®é…ç½®æ‰‹å†Œ.md` - é…ç½®é¡¹ç›®
4. `docs/04-ç¡¬ä»¶è¿žæŽ¥ä¸Žåˆ·å†™.md` - ç¡¬ä»¶æ“ä½œ
5. `docs/05-å¿«é€Ÿå‚è€ƒæ‰‹å†Œ.md` - æ—¥å¸¸å‚è€ƒ

### æ·±åº¦å­¦ä¹ 
- `docs/03-å›ºä»¶ç¼–è¯‘æŒ‡å—.md` - ç†è§£ç¼–è¯‘è¿‡ç¨‹
- `docs/06-æŠ€æœ¯åŽŸç†è§£æž.md` - æ·±å…¥æŠ€æœ¯åŽŸç†

### é¡¹ç›®ç®¡ç†
- `docs/07-é¡¹ç›®å¤‡ä»½ä¸Žéƒ¨ç½²æŒ‡å—.md` - å¤‡ä»½å’Œéƒ¨ç½²
- `docs/08-é¡¹ç›®å¤‡ä»½æˆåŠŸæŒ‡å—.md` - å¤‡ä»½æˆåŠŸå±•ç¤º

## ðŸ› ï¸ å¸¸ç”¨æ“ä½œ

### çŽ¯å¢ƒç®¡ç†
```bash
# æ£€æŸ¥çŽ¯å¢ƒ
./scripts/one_click_verify.sh

# å®‰è£…å·¥å…·
./scripts/one_click_install.sh

# çŽ¯å¢ƒè¯Šæ–­
./scripts/setup_nrf52810.sh
```

### å›ºä»¶æ“ä½œ
```bash
# ç¼–è¯‘å’Œåˆ·å†™ (2ç§’å¹¿æ’­é—´éš”)
./scripts/compile_and_flash_2s.sh

# æ‰‹åŠ¨ç¼–è¯‘ (åœ¨ heystack-nrf5x/nrf52810/armgcc/ ç›®å½•)
make clean
make stflash-nrf52810_xxaa-patched HAS_DCDC=0 HAS_BATTERY=1 ADV_KEYS_FILE=./R0VVSW_keyfile
```

### é¡¹ç›®å¤‡ä»½
```bash
# åˆ›å»ºé¡¹ç›®å¤‡ä»½
./scripts/project_backup.sh

# åˆ›å»ºæœ€ç»ˆå‘å¸ƒåŒ…
./scripts/final_package.sh
```

## â“ æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜
1. **ç¼–è¯‘å¤±è´¥**: æ£€æŸ¥ nRF5 SDK æ˜¯å¦æ­£ç¡®å®‰è£…
2. **åˆ·å†™å¤±è´¥**: æ£€æŸ¥ç¡¬ä»¶è¿žæŽ¥å’Œè°ƒè¯•å™¨
3. **å·¥å…·ç¼ºå¤±**: è¿è¡Œ `./scripts/one_click_install.sh`

### èŽ·å–å¸®åŠ©
- æŸ¥çœ‹ `docs/05-å¿«é€Ÿå‚è€ƒæ‰‹å†Œ.md` çš„æ•…éšœæŽ’é™¤éƒ¨åˆ†
- æ£€æŸ¥ç›¸å…³è¯¦ç»†æ–‡æ¡£
- è¿è¡ŒçŽ¯å¢ƒæ£€æŸ¥è„šæœ¬è¯Šæ–­é—®é¢˜

## ðŸŽ‰ æˆåŠŸæ ‡å¿—

å½“æ‚¨çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¡¨ç¤ºæ“ä½œæˆåŠŸï¼š
```
âœ… å›ºä»¶ç¼–è¯‘å’Œåˆ·å†™æˆåŠŸå®Œæˆï¼
ðŸ“¡ è“ç‰™å¹¿æ’­é—´éš”å·²è®¾ç½®ä¸º 2 ç§’
```

çŽ°åœ¨æ‚¨çš„ nRF52810 è®¾å¤‡å·²ç»æˆåŠŸåˆ·å…¥ AirTag å›ºä»¶ï¼

---
*ä½¿ç”¨æ„‰å¿«ï¼å¦‚æœ‰é—®é¢˜è¯·æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ã€‚*
EOF

echo "ðŸš€ åˆ›å»ºå¿«é€Ÿå¼€å§‹æŒ‡å—..."
cat > QUICKSTART.md << 'EOF'
# âš¡ 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

## ðŸŽ¯ ç›®æ ‡
åœ¨5åˆ†é’Ÿå†…å®Œæˆ nRF52810 AirTag å›ºä»¶çš„åˆ·å†™ã€‚

## ðŸ“‹ å‰ææ¡ä»¶
- macOS ç³»ç»Ÿ (Intel æˆ– Apple Silicon)
- nRF52810 å¼€å‘æ¿
- ST-Link V2 è°ƒè¯•å™¨
- USB æ•°æ®çº¿

## ðŸš€ æ“ä½œæ­¥éª¤

### 1ï¸âƒ£ çŽ¯å¢ƒæ£€æŸ¥ (1åˆ†é’Ÿ)
```bash
# æ£€æŸ¥çŽ¯å¢ƒå¹¶è‡ªåŠ¨ä¿®å¤
./scripts/one_click_verify.sh

# å¦‚æžœæœ‰é—®é¢˜ï¼Œè¿è¡Œè‡ªåŠ¨å®‰è£…
./scripts/one_click_install.sh
```

### 2ï¸âƒ£ ç¡¬ä»¶è¿žæŽ¥ (1åˆ†é’Ÿ)
è¿žæŽ¥ ST-Link V2 åˆ° nRF52810ï¼š
- VCC â†’ 3.3V
- GND â†’ GND  
- SWDIO â†’ SWDIO
- SWCLK â†’ SWCLK

### 3ï¸âƒ£ ä¸‹è½½ SDK (2åˆ†é’Ÿï¼Œä»…é¦–æ¬¡)
å¦‚æžœæ˜¯é¦–æ¬¡ä½¿ç”¨ï¼š
1. è®¿é—®: https://www.nordicsemi.com/Software-and-tools/Software/nRF5-SDK
2. ä¸‹è½½ nRF5 SDK 15.3.0
3. è§£åŽ‹åˆ° `nrf-sdk/` ç›®å½•

### 4ï¸âƒ£ ä¸€é”®åˆ·å†™ (1åˆ†é’Ÿ)
```bash
# ç¼–è¯‘å¹¶åˆ·å†™å›ºä»¶
./scripts/compile_and_flash_2s.sh
```

## âœ… æˆåŠŸæ ‡å¿—
çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºè¡¨ç¤ºæˆåŠŸï¼š
```
âœ… å›ºä»¶ç¼–è¯‘å’Œåˆ·å†™æˆåŠŸå®Œæˆï¼
ðŸ“¡ è“ç‰™å¹¿æ’­é—´éš”å·²è®¾ç½®ä¸º 2 ç§’
```

## ðŸŽ‰ å®Œæˆï¼
æ‚¨çš„ nRF52810 çŽ°åœ¨å·²ç»æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ AirTag è®¾å¤‡ï¼

## ðŸ“š ä¸‹ä¸€æ­¥
- æŸ¥çœ‹ `docs/README-æ–‡æ¡£å¯¼èˆª.md` äº†è§£æ›´å¤šåŠŸèƒ½
- é˜…è¯» `docs/05-å¿«é€Ÿå‚è€ƒæ‰‹å†Œ.md` å­¦ä¹ å¸¸ç”¨æ“ä½œ
- æŽ¢ç´¢ `docs/06-æŠ€æœ¯åŽŸç†è§£æž.md` æ·±å…¥äº†è§£æŠ€æœ¯ç»†èŠ‚

---
*å¿«é€Ÿå¼€å§‹å®Œæˆï¼äº«å—æ‚¨çš„ DIY AirTagï¼*
EOF

echo "ðŸ—œï¸  åˆ›å»ºæœ€ç»ˆåŽ‹ç¼©åŒ…..."
cd ..
tar -czf "${FINAL_PACKAGE}.tar.gz" "$FINAL_PACKAGE"

# èŽ·å–æ–‡ä»¶å¤§å°
PACKAGE_SIZE=$(du -h "${FINAL_PACKAGE}.tar.gz" | cut -f1)

echo ""
echo "ðŸŽ‰ === æœ€ç»ˆæ‰“åŒ…å®Œæˆï¼==="
echo ""
echo "ðŸ“¦ æœ€ç»ˆå‘å¸ƒåŒ…: ${FINAL_PACKAGE}.tar.gz"
echo "ðŸ“ åŒ…å¤§å°: $PACKAGE_SIZE"
echo "ðŸ“ è§£åŽ‹ç›®å½•: $FINAL_PACKAGE"
echo ""
echo "ðŸ“‹ åŒ…å«å†…å®¹:"
echo "  âœ… å®Œæ•´æ–‡æ¡£ç³»ç»Ÿ (9ä¸ªæ–‡æ¡£)"
echo "  âœ… è‡ªåŠ¨åŒ–è„šæœ¬é›†åˆ (6ä¸ªè„šæœ¬)"
echo "  âœ… é¡¹ç›®æºç å’Œé…ç½®"
echo "  âœ… å·¥å…·è¯´æ˜Žå’Œå¿«é€ŸæŒ‡å—"
echo "  âœ… å¯†é’¥æ–‡ä»¶ (å¦‚æžœå­˜åœ¨)"
echo "  âœ… å·²ç¼–è¯‘å›ºä»¶ (å¦‚æžœå­˜åœ¨)"
echo ""
echo "ðŸš€ ä½¿ç”¨æ–¹æ³•:"
echo "1. è§£åŽ‹: tar -xzf ${FINAL_PACKAGE}.tar.gz"
echo "2. è¿›å…¥: cd $FINAL_PACKAGE"
echo "3. å¼€å§‹: é˜…è¯» QUICKSTART.md æˆ– USAGE.md"
echo ""
echo "ðŸŽ¯ è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€å¯ç‹¬ç«‹ä½¿ç”¨çš„ nRF52810 AirTag å¼€å‘åŒ…ï¼"
echo ""
# ðŸ”Œ ç¡¬ä»¶è¿žæŽ¥ä¸Žè°ƒè¯•æ‰‹å†Œ

æœ¬æŒ‡å—æ•´åˆäº†ç¡¬ä»¶æŽ¥çº¿ã€è°ƒè¯•å™¨é€‰æ‹©åŠèŠ¯ç‰‡ä¿æŠ¤ä¿®å¤çš„å®Œæ•´æµç¨‹ã€‚

## 1. è°ƒè¯•å™¨é€‰æ‹©

| è°ƒè¯•å™¨ | æŽ¨èæŒ‡æ•° | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|--------|---------|------|---------|
| **J-Link** | â­â­â­â­â­ | é€Ÿåº¦å¿«ã€ç¨³å®šæ€§é«˜ | ä¸“ä¸šç”¨æˆ·/æ‰¹é‡ç”Ÿäº§ |
| **ST-Link V2** | â­â­â­â­ | æ€§ä»·æ¯”é«˜ã€æ˜“èŽ·å– | æ—¥å¸¸å¼€å‘ |
| **DAPLink** | â­â­â­ | å¼€æºã€å…é©± | ç‰¹æ®Šéœ€æ±‚ |

---

## 2. æ ‡å‡† SWD æŽ¥çº¿

æ‰€æœ‰ nRF5 èŠ¯ç‰‡éƒ½ä½¿ç”¨ 4 çº¿ SWD æŽ¥å£ï¼š

```
è°ƒè¯•å™¨          nRF èŠ¯ç‰‡
------         --------
SWDIO   -->    SWDIO
SWCLK   -->    SWCLK
GND     -->    GND
3.3V    -->    VCC (å¯é€‰)
```

> âš ï¸ **é‡è¦**: GND å¿…é¡»è¿žæŽ¥ï¼å¦åˆ™ä¼šå¯¼è‡´è¿žæŽ¥ä¸ç¨³å®šã€‚

---

## 3. å¸¸è§æ¨¡å—æŽ¥çº¿å›¾

### 3.1 åœ†å½¢é˜²ä¸¢å™¨ï¼ˆé€šç”¨åž‹å·ï¼‰

**å¸¸è§èŠ¯ç‰‡**: nRF51822/52832  
**ç„Šç›˜å®šä¹‰**ï¼ˆä»Žä¸Šè‡³ä¸‹ï¼‰ï¼š

1. **CLK** (SWCLK)
2. **DIO** (SWDIO)
3. **VCC** (3.3V)
4. **GND**

### 3.2 ç»¿è‰²è¿·ä½ æ¨¡å—ï¼ˆSMD å°è£…ï¼‰

**å¸¸è§èŠ¯ç‰‡**: nRF52832/52810/52811  
**å¼•è„šæ ‡æ³¨**ï¼š

- **GND**: é¡¶éƒ¨æŽ¥åœ°ç„Šç›˜
- **VCC**: 3.3V ç”µæºè¾“å…¥
- **CLK**: SWCLK
- **DIO**: SWDIO

### 3.3 é»‘è‰²åœ†å½¢é˜²ä¸¢å™¨ï¼ˆè¶…è–„åž‹ï¼‰

**å¸¸è§èŠ¯ç‰‡**: nRF52832  
**æµ‹è¯•ç‚¹**ï¼š

- **DIO**: å³ä¾§é ä¸Š
- **CLK**: å³ä¾§é ä¸‹
- **GND/VCC**: ä»Žç”µæ± åº§å¼•å‡º

### 3.4 ç»¿è‰²é•¿æ¡æ¨¡å—ï¼ˆé‚®ç¥¨å­”ï¼‰

**å¸¸è§èŠ¯ç‰‡**: nRF51822  
**å³ä¾§ç„Šç›˜**ï¼ˆä»Žä¸Šè‡³ä¸‹ï¼‰ï¼š

- **GND**
- **CLK** (SWCLK)
- **DIO** (SWDIO)
- **VCC** (3.3V)

### 3.5 Unice æ°´æ»´å½¢ (GS1-P2)

**èŠ¯ç‰‡åž‹å·**: nRF52832  
**ç„Šç›˜å®šä¹‰**ï¼ˆä»Žå·¦å‘å³ï¼‰ï¼š

1. **GND** (æ–¹å½¢ç„Šç›˜)
2. **CLK** (SWDCLK)
3. **DIO** (SWDIO)
4. **VCC** (3.3V)

> ðŸ’¡ **é€šç”¨æç¤º**: ä»¥ä¸ŠæŽ¥çº¿å®šä¹‰å¯¹åŒç³»åˆ—èŠ¯ç‰‡é€šç”¨ã€‚å³ä½¿æ¨¡å—æ ‡æ³¨çš„èŠ¯ç‰‡åž‹å·ä¸åŒï¼ˆå¦‚ nRF52810 vs nRF52832ï¼‰ï¼Œåªè¦å¤–å½¢ç›¸ä¼¼ï¼ŒæŽ¥çº¿æ–¹å¼é€šå¸¸ç›¸åŒã€‚

> ðŸ“¸ æ›´å¤šæŽ¥çº¿å›¾å‚è€ƒ: `../archive/17-å¸¸è§å¼€å‘æ¿æŽ¥çº¿å›¾é›†.md`

---

## 4. èŠ¯ç‰‡ä¿æŠ¤è§£é™¤ï¼ˆæ•‘ç –ï¼‰

### 4.1 æ£€æµ‹èŠ¯ç‰‡ä¿æŠ¤

å¦‚æžœé‡åˆ°ä»¥ä¸‹æŠ¥é”™ï¼Œè¯´æ˜ŽèŠ¯ç‰‡è¢«ä¿æŠ¤ï¼š

- `unable to connect to the target`
- `nRF52 device has APPROTECT enabled`
- `Programming failed`

### 4.2 æ–¹æ³• A: ä½¿ç”¨ Web Studioï¼ˆæŽ¨èï¼‰

Web Studio ä¼šè‡ªåŠ¨æ£€æµ‹èŠ¯ç‰‡ä¿æŠ¤å¹¶å°è¯• **Mass Erase**ï¼š

1. å¯åŠ¨ `python3 nrf5_airtag_web.py`
2. ç‚¹å‡»"æŽ¢æµ‹è®¾å¤‡"
3. å¦‚æžœæ˜¾ç¤º `Chip Protected`ï¼Œç‚¹å‡»"å¼€å§‹åˆ·æœº"
4. ç³»ç»Ÿä¼šè‡ªåŠ¨æ‰§è¡Œ Mass Erase è§£é”

### 4.3 æ–¹æ³• B: ä½¿ç”¨ nrfjprog (J-Link)

```bash
# nRF52 ç³»åˆ—
nrfjprog --recover -f nrf52

# nRF51 ç³»åˆ—
nrfjprog --recover -f nrf51

# éªŒè¯
nrfjprog --readcode -f nrf52
```

### 4.4 æ–¹æ³• C: ä½¿ç”¨ OpenOCD (ST-Link)

```bash
cd heystack-nrf5x/nrf52832/armgcc  # æˆ–å¯¹åº”èŠ¯ç‰‡ç›®å½•
openocd -f openocd.cfg -c "init; halt; nrf5 mass_erase; reset; exit"
```

**æˆåŠŸæ ‡å¿—**:

```
Info : Mass erase completed.
```

### 4.5 å¸¸è§é—®é¢˜

**Q: Mass Erase åŽè®¾å¤‡ä»æ— æ³•è¿žæŽ¥ï¼Ÿ**
A:

1. æ£€æŸ¥ç¡¬ä»¶è¿žæŽ¥
2. æ›´æ¢æœé‚¦çº¿
3. ç¡®è®¤è°ƒè¯•å™¨ä¾›ç”µæ­£å¸¸

**Q: ST-Link æç¤ºéœ€è¦ CTRL-APï¼Ÿ**
A: è¿™æ˜¯æ­£å¸¸æç¤ºï¼Œ`mass_erase` å‘½ä»¤ä»ç„¶æœ‰æ•ˆï¼Œå¿½ç•¥å³å¯ã€‚

---

## 5. æŽ¥çº¿ç¦å¿Œ

âŒ **é”™è¯¯æ“ä½œ**:

- SWDIO å’Œ SWCLK äº¤å‰è¿žæŽ¥
- å¿˜è®°è¿žæŽ¥ GND
- åœ¨è®¾å¤‡è¿è¡Œæ—¶çƒ­æ’æ‹”è°ƒè¯•å™¨
- åŒæ—¶è¿žæŽ¥è°ƒè¯•å™¨ 3.3V å’Œç”µæ± ä¾›ç”µï¼ˆå¯èƒ½çƒ§æ¯èŠ¯ç‰‡ï¼‰

âœ… **æ­£ç¡®åšæ³•**:

- å…ˆè¿žæŽ¥ GND
- ç¡®è®¤å¼•è„šå®šä¹‰åŽå†é€šç”µ
- ä½¿ç”¨ä¸‡ç”¨è¡¨æµ‹é‡ç”µåŽ‹

---

## 6. æ•…éšœæŽ’æŸ¥æµç¨‹

```mermaid
graph TD
    A[æ— æ³•è¿žæŽ¥è®¾å¤‡] --> B{æ£€æŸ¥ç‰©ç†è¿žæŽ¥}
    B -->|çº¿ç¼†æ¾åŠ¨| C[é‡æ–°è¿žæŽ¥]
    B -->|è¿žæŽ¥æ­£å¸¸| D{æ£€æŸ¥è°ƒè¯•å™¨}
    D -->|é©±åŠ¨é—®é¢˜| E[é‡è£…é©±åŠ¨]
    D -->|é©±åŠ¨æ­£å¸¸| F{èŠ¯ç‰‡ä¿æŠ¤?}
    F -->|æ˜¯| G[æ‰§è¡Œ Mass Erase]
    F -->|å¦| H[æ£€æŸ¥ä¾›ç”µ]
```

---

> ç›¸å…³æ–‡æ¡£:
>
> - [å¿«é€Ÿå¼€å§‹](../getting-started/index.md)
> - [å‘½ä»¤è¡Œåˆ·å†™å·¥å…·](../manuals/cli-tool.md)
